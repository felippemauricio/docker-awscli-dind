stages:
  - docker-hub

jobs:
  include:

    - stage: docker-hub
      services:
        - docker
      env:
        - IMAGE_NAME=felippemauricio/awscli-dind
        - TAG=:latest
      script:
        - echo $DOCKER_PASSWORD | docker login -u $DOCKER_USERNAME --password-stdin
        - docker build -t $IMAGE_NAME .
        - docker tag $IMAGE_NAME "$IMAGE_NAME$TAG"
        - docker push "$IMAGE_NAME$TAG"
      on:
        branch: master
